<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="GENERATOR" content="VSdocman - documentation generator; http://www.helixoft.com" />
	<title>Files.EnumDirectory Method</title>

	<link rel="stylesheet" type="text/css" href="msdn2017/msdn2017.css"></link>
	<script src="msdn2017/msdn2017.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shCore_helixoft.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushVb.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushFSharp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushCpp.js" type="text/javascript"></script>
	<script src="SyntaxHighlighter/scripts/shBrushJScript.js" type="text/javascript"></script>
	<link href="SyntaxHighlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
	<link href="SyntaxHighlighter/styles/shThemeMsdnLW.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript">
		SyntaxHighlighter.all();
	</script>				

	<script type="text/javascript">
<!--
if (self.name != "vbdocright") {
	if (location.search != "?toc=no") {
		var filename = location.pathname.replace(/\\/g, "/");
		filename = filename.substring(filename.lastIndexOf('/')+1);
		location.replace("index.html#" + filename);
	} 
}

function replaceTitleAndUrl(win, title, url) {
	if(history.replaceState) {
		win.history.replaceState(null, title, url);
	} else {
		win.document.title = document.title;
		win.location.replace(url);
	}
}
//-->
	</script>	
</head>

<body style="direction: ltr;">
	<script type="text/javascript">
		try {
			if (location.search != "?toc=no") {
				parent.document.title = document.title;
				var filename = location.pathname.replace(/\\/g, "/");
				filename = filename.substring(filename.lastIndexOf('/')+1);
				if (window.parent.location.search == null || window.parent.location.search != "?" + filename) {
					if (window.parent.location.hash == null || window.parent.location.hash != "#" + filename) {
						replaceTitleAndUrl(window.parent, document.title, "index.html#" + filename);
					}
				}
			}
		} catch (ex) {}
	</script>
	<div id="topic">
<!--HEADER START-->
  <div id="header">
  	<div id="runningHeaderText">Au Reference</div>
  	<h1 class="title">Files.EnumDirectory Method</h1>
  	<div id="headerLinks">

	<a href="#seeAlsoSection">See Also</a>

		</div>
		<hr />
	</div>
<!--HEADER END-->
    
		<div id="mainSection">
      <div id="mainBody">
        <p />
       
        Gets names and other info of files and subdirectories in the specified directory.
Returns an enumerable collection of <a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a> objects containing the info.
By default gets only direct children. Use flag <strong>AndSubdirectories</strong> to get all descendants.


        <p /><strong>Namespace:</strong>
<a href="topic_00000000000000DB.html">Au</a>




        <br /><strong>Assembly:</strong> Au (in Au.dll)










<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Syntax</a></span>
		<div><hr /></div>
	</div>

	<div id="syntaxSection" class="section">	
	
	
	<div id="syntaxCodeBlocks">
		<div class="codeSnippetContainer">		
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCornerActive">
				</div>
				<div class="codeSnippetTab csFirstTab csActiveTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeFsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Fsharp');">F#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeVB">
					<pre xml:space="preserve" class="brush: vb">Public Shared Function EnumDirectory( _&nbsp;<br />   ByVal <i>directoryPath</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>, _&nbsp;<br />   Optional ByVal <i>flags</i> As <a target="_top" href="topic_000000000000049D.html" onclick="this.target='';return true;">FEFlags</a> = 0, _&nbsp;<br />   Optional ByVal <i>filter</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/bb549151.aspx">Func</a>(Of <a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a>, <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">Boolean</a>) = null, _&nbsp;<br />   Optional ByVal <i>errorHandler</i> As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/018hxwa8.aspx">Action</a>(Of <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">String</a>) = null _&nbsp;<br />) As <a target="_top" href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable</a>(Of <a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a>)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">This language is not supported or no code example is available.</pre>			
				</div>
			</div>
		</div>
		
		<div class="codeSnippetContainer">
			<div class="codeSnippetTabs">
				<div class="codeSnippetTabLeftCorner">
				</div>
				<div class="codeSnippetTab csFirstTab csNaTab codeVB">
					<a>VB</a>
				</div>
				<div class="codeSnippetTab csActiveTab codeCsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Csharp');">C#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeFsharp">
					<a href="javascript: CodeSnippet_SetLanguage('Fsharp');">F#</a>
				</div>
				<div class="codeSnippetTab csNaTab codeCpp">
					<a href="javascript: CodeSnippet_SetLanguage('Cpp');">C++</a>
				</div>
				<div class="codeSnippetTab csLastTab csNaTab codeJScript">
					<a href="javascript: CodeSnippet_SetLanguage('JScript');">JScript</a>
				</div>
				<div class="codeSnippetTabRightCorner">
				</div>
				<div style="clear:both;">
				</div>
			</div>
	
			<div class="codeSnippetCodeCollection">
				<div class="codeSnippetToolbar">
					<a title="Copy to clipboard." href="javascript:void(0)" onclick="CopyCode(this);">Copy</a>
				</div>
				
				<div class="codeSnippetCode codeCsharp">
					<pre xml:space="preserve" class="brush: csharp">public static <a target="_top" href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable</a>&lt;<a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a>&gt; EnumDirectory(&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> <i>directoryPath</i>,&nbsp;<br />   <a target="_top" href="topic_000000000000049D.html" onclick="this.target='';return true;">FEFlags</a> <i>flags</i> = 0,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/bb549151.aspx">Func</a>&lt;<a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a>, <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a>&gt; <i>filter</i> = null,&nbsp;<br />   <a target="_top" href="http://msdn2.microsoft.com/en-us/library/018hxwa8.aspx">Action</a>&lt;<a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a>&gt; <i>errorHandler</i> = null&nbsp;<br />)</pre>			
				</div>
				<div class="codeSnippetCode codeNA">
					<pre xml:space="preserve">This language is not supported or no code example is available.</pre>			
				</div>
			</div>
		</div>


		
		
	</div>


<h4 class="subHeading">
	Parameters</h4><dl paramName="directoryPath">
	<dt>
		<span class="parameter">
			directoryPath
		</span>
	</dt>
	<dd>
		Type: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a> 
		<p>
			Full path of the directory. 
		</p>
	</dd>
</dl>
<dl paramName="flags">
	<dt>
		<span class="parameter">
			flags
		</span>
	</dt>
	<dd>
		Type: <a target="_top" href="topic_000000000000049D.html" onclick="this.target='';return true;">FEFlags</a> 
		<p>
			 
		</p>
	</dd>
</dl>
<dl paramName="filter">
	<dt>
		<span class="parameter">
			filter
		</span>
	</dt>
	<dd>
		Type: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/bb549151.aspx">Func</a>&lt;<a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a>, <a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.boolean.aspx">bool</a>&gt; 
		<p>
			A callback function to call for each file and subdirectory.
If it returns false, the file/subdirectory is not included in results.
This can be useful when EnumDirectory is called indirectly, for example by the Copy method. If you call it directly, you can instead skip processing the file in your foreach loop. 
		</p>
	</dd>
</dl>
<dl paramName="errorHandler">
	<dt>
		<span class="parameter">
			errorHandler
		</span>
	</dt>
	<dd>
		Type: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/018hxwa8.aspx">Action</a>&lt;<a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.string.aspx">string</a>&gt; 
		<p>
			A callback function to call when fails to get children of a subdirectory, when using flag <strong>AndSubdirectories</strong>.
It receives the subdirectory path. It can call <a target="_top" href="topic_0000000000000004.html" onclick="this.target='';return true;">GetError</a> and throw an exception.
If it does not throw an exception, the enumeration continues as if the directory is empty.
If errorHandler not used, then throws exception.
Read more in Remarks. 
		</p>
	</dd>
</dl>

<p />

	<h4 class="subHeading">
		Return Value</h4>
	Type: <a target="_top" href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable</a>&lt;<a target="_top" href="topic_00000000000004A9.html" onclick="this.target='';return true;">FEFile</a>&gt; 
	












	</div>
</div>



<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Exceptions</a></span>
		<div><hr /></div>
	</div>

	<div id="exceptionsSection" class="section">	
	<table>
		<tr>
			<th>
				Exception type
			</th>
			<th>
				Condition
			</th>
		</tr>
		<tr>
			<td>
				<p>
<a href="topic_00000000000002BC.html">AuException</a>

				</p>
			</td>
			<td>
				<p>
					Failed to get children of directoryPath or of a subdirectory. Read more in Remarks. 
				</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>
<a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.io.directorynotfoundexception.aspx">DirectoryNotFoundException</a>

				</p>
			</td>
			<td>
				<p>
					directoryPath directory does not exist. 
				</p>
			</td>
		</tr>
		<tr>
			<td>
				<p>
<a target="_top" href="http://msdn2.microsoft.com/en-us/library/system.argumentexception.aspx">ArgumentException</a>

				</p>
			</td>
			<td>
				<p>
					directoryPath is invalid path or not full path. 
				</p>
			</td>
		</tr>
			
	</table>
	</div>
</div>


<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Remarks</a></span>
		<div><hr /></div>
	</div>

	<div id="remarksSection" class="section">	
			Uses API &lt;msdn&gt;FindFirstFile&lt;/msdn&gt;.

The paths that this function gets are normalized, ie may not start with exact directoryPath string. Expanded environment variables (see <a target="_top" href="topic_0000000000000593.html" onclick="this.target='';return true;">ExpandEnvVar</a>), &quot;..&quot;, DOS path etc.
Paths longer than <a target="_top" href="topic_000000000000059F.html" onclick="this.target='';return true;">MaxDirectoryPathLength</a> have @&quot;\\?\&quot; prefix (see <a target="_top" href="topic_000000000000059C.html" onclick="this.target='';return true;">PrefixLongPathIfNeed</a>).
For symbolic links and mounted folders, gets info of the link/folder and not of its target.

These errors are ignored:
1. Access denied (usually because of security permissions), unless used flag FailIfAccessDenied.
2. Missing target directory of a symbolic link or mounted folder.
When an error is ignored, the function works as if that [sub]directory is empty; does not throw exception and does not call errorHandler.

Enumeration of a subdirectory starts immediately after the subdirectory itself is retrieved.
	</div>					
</div>













 
 








  







	
	
	
	
	

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">Applies to</a></span>
		<div><hr /></div>
	</div>

	<div id="frameworksSection" class="section">	
  <h4 class="subHeading">.NET Framework</h4>Supported in: 4.5, 4.5.1, 4.5.2, 4.6, 4.6.1, 4.6.2, 4.7, 4.7.1<br />










	
	
	</div>					
</div>

<div class="section_container">
	<div class="section_heading">
		<span><a href="javascript:void(0)" title="Collapse" onclick="toggleSection(this);">See Also</a></span>
		<div><hr /></div>
	</div>

	<div id="seeAlsoSection" class="section">	
		<div>
			<a href="topic_0000000000000475.html">Files Class</a><br />



<a href="topic_00000000000000DB.html">Au Namespace</a><br />


			

		</div>
	</div>					
</div>
			</div>
			</div>
      <div id="footer">
      	<p><span style="color: #FF0000;">Generated with unregistered version of <a target="_top" href="http://www.helixoft.com/vsdocman/overview.html">VSdocman</a></span>&nbsp;<br />Your own footer text will only be shown in registered version.</p>
      </div>
    </div>
  	<script type="text/javascript">
<!--
	try {
		parent.frames["vbdocswitch"].expandLinkInToc(location.href);
	} catch (ex) {}
//-->
		</script>	
  </body>
</html>

