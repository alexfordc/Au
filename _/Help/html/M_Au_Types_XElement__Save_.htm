<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XElement_.Save_ Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Save_ method" /><meta name="System.Keywords" content="XElement_.Save_ method" /><meta name="Microsoft.Help.F1" content="Au.Types.XElement_.Save_" /><meta name="Microsoft.Help.Id" content="M:Au.Types.XElement_.Save_(System.Xml.Linq.XElement,System.String,System.Boolean,System.Nullable{System.Xml.Linq.SaveOptions})" /><meta name="Description" content="Saves XML to a file in a safer way. Uses System.Xml.Linq.XElement.Save and File_.Save." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au.Types" /><meta name="file" content="M_Au_Types_XElement__Save_" /><meta name="guid" content="M_Au_Types_XElement__Save_" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Au Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\3d4fd35d-4b48-4167-b34f-44e9afc13fc3.htm" title="Au Class Library" tocid="roottoc">Au Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Au_Types.htm" title="Au.Types" tocid="N_Au_Types">Au.Types</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Au_Types_XElement_.htm" title="XElement_ Class" tocid="T_Au_Types_XElement_">XElement_ Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Au_Types_XElement_.htm" title="XElement_ Methods" tocid="Methods_T_Au_Types_XElement_">XElement_ Methods</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Au_Types_XElement__Attribute_.htm" title="Attribute_ Method " tocid="Overload_Au_Types_XElement__Attribute_">Attribute_ Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Au_Types_XElement__Descendant_.htm" title="Descendant_ Method " tocid="Overload_Au_Types_XElement__Descendant_">Descendant_ Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__Descendants_.htm" title="Descendants_ Method " tocid="M_Au_Types_XElement__Descendants_">Descendants_ Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__Element_.htm" title="Element_ Method " tocid="M_Au_Types_XElement__Element_">Element_ Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Au_Types_XElement__ElementGetOrAdd_.htm" title="ElementGetOrAdd_ Method " tocid="Overload_Au_Types_XElement__ElementGetOrAdd_">ElementGetOrAdd_ Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__HasAttribute_.htm" title="HasAttribute_ Method " tocid="M_Au_Types_XElement__HasAttribute_">HasAttribute_ Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__Load.htm" title="Load Method " tocid="M_Au_Types_XElement__Load">Load Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__NextElement_.htm" title="NextElement_ Method " tocid="M_Au_Types_XElement__NextElement_">NextElement_ Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__PreviousElement_.htm" title="PreviousElement_ Method " tocid="M_Au_Types_XElement__PreviousElement_">PreviousElement_ Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_Types_XElement__Save_.htm" title="Save_ Method " tocid="M_Au_Types_XElement__Save_">Save_ Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>XElement_<span id="LSTD4078064_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_0?cpp=::|nu=.");</script>Save_ Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">            Saves XML to a file in a safer way.<br />            Uses <a href="http://msdn2.microsoft.com/en-us/library/bb538458" target="_blank">System.Xml.Linq.XElement.Save</a> and <a href="M_Au_File__Save.htm">File_.Save</a>.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au_Types.htm">Au.Types</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Save_</span>(
	<span class="keyword">this</span> <span class="identifier">XElement</span> <span class="parameter">t</span>,
	<span class="identifier">string</span> <span class="parameter">file</span>,
	<span class="identifier">bool</span> <span class="parameter">backup</span> = <span class="keyword">false</span>,
	<span class="identifier">Nullable</span>&lt;<span class="identifier">SaveOptions</span>&gt; <span class="parameter">options</span> = <span class="keyword">null</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">t</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/bb340098" target="_blank">System.Xml.Linq<span id="LSTD4078064_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>XElement</a><br /></dd><dt><span class="parameter">file</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTD4078064_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />File. Must be full path. Can contain environment variables etc, see <a href="M_Au_Path__ExpandEnvVar.htm">Path_.ExpandEnvVar</a>. The file can exist or not; this function overwrites it.</dd><dt><span class="parameter">backup</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LSTD4078064_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />Create backup file named file + "~backup".</dd><dt><span class="parameter">options</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/b3h38hb0" target="_blank">System<span id="LSTD4078064_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Nullable</a><span id="LSTD4078064_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_5?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="http://msdn2.microsoft.com/en-us/library/bb551441" target="_blank">SaveOptions</a><span id="LSTD4078064_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD4078064_6?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br /></dd></dl><h4 class="subHeading">Usage Note</h4>In Visual Basic and C#, you can call this method as an instance method on any object of type <a href="http://msdn2.microsoft.com/en-us/library/bb340098" target="_blank">XElement</a>. When you use instance method syntax to call this method, omit the first parameter. For more information, see <a href="http://msdn.microsoft.com/en-us/library/bb384936.aspx" target="_blank">Extension Methods (Visual Basic)</a> or <a href="http://msdn.microsoft.com/en-us/library/bb383977.aspx" target="_blank">Extension Methods (C# Programming Guide)</a>.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/c18k6c59" target="_blank">Exception</a></td><td>Exceptions of <a href="http://msdn2.microsoft.com/en-us/library/bb360171" target="_blank">System.Xml.Linq.XElement.Save</a> and <a href="M_Au_File__Save.htm">File_.Save</a>.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>Not full path.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/hccy4eyd" target="_blank">IOException</a></td><td>Failed to replace file. The file-write function also can thow it.</td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection">            The file-write functions provided by .NET and Windows API are unreliable, because:<br />            1. Fails if the file is temporarily open by another process or thread without sharing.<br />            2. Can corrupt file data. If this thread, process, PC or disk dies while writing, may write only part of data or just make empty file. Usually it happens when PC is turned off incorrectly.<br /><br />            To protect from 1, this functions waits/retries if the file is temporarily open/locked, like <a href="M_Au_File__WaitIfLocked.htm">File_.WaitIfLocked</a>.<br />            To protect from 2, this function writes to a temporary file and renames/replaces the specified file using API <a href="https://www.google.com/search?q=site:docs.microsoft.com+ReplaceFile" target="_blank">ReplaceFile</a>. Although not completely atomic, it ensures that file data is not corrupt; if cannot write all data, does not change existing file data.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_Types_XElement_.htm">XElement_ Class</a></div><div class="seeAlsoStyle"><a href="N_Au_Types.htm">Au.Types Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>