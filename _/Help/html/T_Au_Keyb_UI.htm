<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Keyb.UI Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Keyb.UI class" /><meta name="System.Keywords" content="Au.Keyb.UI class" /><meta name="Microsoft.Help.F1" content="Au.Keyb.UI" /><meta name="Microsoft.Help.Id" content="T:Au.Keyb.UI" /><meta name="Description" content="Gets key states for using in UI code (forms, WPF)." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="T_Au_Keyb_UI" /><meta name="guid" content="T_Au_Keyb_UI" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Au Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\3d4fd35d-4b48-4167-b34f-44e9afc13fc3.htm" title="Au Class Library" tocid="roottoc">Au Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Au.htm" title="Au" tocid="N_Au">Au</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Au_Keyb_UI.htm" title="Keyb.UI Class" tocid="T_Au_Keyb_UI">Keyb.UI Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Properties_T_Au_Keyb_UI.htm" title="UI Properties" tocid="Properties_T_Au_Keyb_UI">UI Properties</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Au_Keyb_UI.htm" title="UI Methods" tocid="Methods_T_Au_Keyb_UI">UI Methods</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Keyb<span id="LST8ABA4FC7_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8ABA4FC7_0?cpp=::|nu=.");</script>UI Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Gets key states for using in UI code (forms, WPF).
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LST8ABA4FC7_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8ABA4FC7_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">Au<span id="LST8ABA4FC7_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8ABA4FC7_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Keyb<span id="LST8ABA4FC7_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8ABA4FC7_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UI</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EACA');return false;" title="Copy">Copy</a></div></div><div id="ID1EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="identifier">UI</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EACA");</script></div><p>The <span class="selflink">Keyb<span id="LST8ABA4FC7_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8ABA4FC7_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UI</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="propertyList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsAlt.htm">IsAlt</a></td><td><div class="summary">
            Returns true if the Alt key is down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsCapsLock.htm">IsCapsLock</a></td><td><div class="summary">
            Returns true if the Caps Lock key is toggled.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsCtrl.htm">IsCtrl</a></td><td><div class="summary">
            Returns true if the Ctrl key is down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsNumLock.htm">IsNumLock</a></td><td><div class="summary">
            Returns true if the Num Lock key is toggled.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsScrollLock.htm">IsScrollLock</a></td><td><div class="summary">
            Returns true if the Scroll Lock key is toggled.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsShift.htm">IsShift</a></td><td><div class="summary">
            Returns true if the Shift key is down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsWin.htm">IsWin</a></td><td><div class="summary">
            Returns true if the Win key is down (pressed).
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_GetKeyState.htm">GetKeyState</a></td><td><div class="summary">
            Calls API <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyState" target="_blank">GetKeyState</a> and returns its return value.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_GetMod.htm">GetMod</a></td><td><div class="summary">
            Gets flags indicating which modifier keys are down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_IsMod.htm">IsMod</a></td><td><div class="summary">
            Returns true if some modifier keys are down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_IsPressed.htm">IsPressed</a></td><td><div class="summary">
            Returns true if the specified key or mouse button is down (pressed).
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID5RBSection" class="collapsibleSection">
            Use functions of this class when processing user input events in user interface code (forms, WPF). In other code (automation scrits, etc) usually it's better to use functions of <a href="T_Au_Keyb.htm">Keyb</a> class. Functions of this class are similar to .NET's <b>Control.ModifierKeys</b>, <b>Keyboard.Modifiers</b> etc, but may be easier to use.<br /><br />            In Windows there are two API to get key state (down or up) - <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyState" target="_blank">GetKeyState</a> and <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetAsyncKeyState" target="_blank">GetAsyncKeyState</a>. In most cases they return the same result, but not always.<br /><br />            API <b>GetAsyncKeyState</b> is used by class <a href="T_Au_Keyb.htm">Keyb</a> and not by this class (<b>Keyb.UI</b>). When the user (or some software) presses or releases a key, <b>GetAsyncKeyState</b> sees the change immediately. It is good in automation scripts, but not good in UI code because the state is not synchronized with the message queue.<br /><br />            This class (<b>Keyb.UI</b>) uses API <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyState" target="_blank">GetKeyState</a>. In the foreground thread (of the active window), it sees key state changes not immediately but after the thread reads key messages from its queue. It is good in UI threads. In background threads this API usually works like <b>GetAsyncKeyState</b>, but it depends on API <a href="https://www.google.com/search?q=site:docs.microsoft.com+AttachThreadInput" target="_blank">AttachThreadInput</a> and in some cases is less reliable, for example may be unaware of keys pressed before the thread started.<br /><br />            The key state returned by these API is not always the same as of the physical keyboard. There is no API to get physical state. The two most common cases when it is different:<br />            1. When the key is pressed or released by software, such as the <b>Key</b> function of this library.<br />            2. When the key is blocked by a low-level hook. For example, hotkey triggers of this library use hooks.<br /><br />            Also there is API <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyboardState" target="_blank">GetKeyboardState</a>. It gets states of all keys in single call. Works like <b>GetKeyState</b>.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID6RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>