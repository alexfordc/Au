<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>File_.Save Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Save method" /><meta name="System.Keywords" content="File_.Save method" /><meta name="Microsoft.Help.F1" content="Au.File_.Save" /><meta name="Microsoft.Help.Id" content="M:Au.File_.Save(System.String,System.Action{System.String},System.Boolean,System.Int32)" /><meta name="Description" content="Writes any data to a file in a safe way, using a callback function." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="M_Au_File__Save" /><meta name="guid" content="M_Au_File__Save" /><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>File_<span id="LST1E515D81_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_0?cpp=::|nu=.");</script>Save Method </h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">
            Writes any data to a file in a safe way, using a callback function.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Save</span>(
	<span class="identifier">string</span> <span class="parameter">file</span>,
	<span class="identifier">Action</span>&lt;<span class="identifier">string</span>&gt; <span class="parameter">writer</span>,
	<span class="identifier">bool</span> <span class="parameter">backup</span> = <span class="keyword">false</span>,
	<span class="identifier">int</span> <span class="parameter">lockedWaitMS</span> = 2000
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">file</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST1E515D81_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />File. Must be full path. Can contain environment variables etc, see <a href="M_Au_Path__ExpandEnvVar.htm">Path_.ExpandEnvVar</a>. The file can exist or not; this function overwrites it.</dd><dt><span class="parameter">writer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/018hxwa8" target="_blank">System<span id="LST1E515D81_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Action</a><span id="LST1E515D81_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_3?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">String</a><span id="LST1E515D81_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_4?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />Lambda that creates/writes/closes temporary file. Its parameter is the full path of the temporary file. The file normally does not exist, but can.</dd><dt><span class="parameter">backup</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST1E515D81_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />Create backup file named file + "~backup".</dd><dt><span class="parameter">lockedWaitMS</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST1E515D81_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1E515D81_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />If cannot open file because it is open by another process etc, wait max this number of milliseconds. Can be <a href="http://msdn2.microsoft.com/en-us/library/65fh19xy" target="_blank">System.Threading.Timeout.Infinite</a> (-1).</dd></dl><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Exceptions</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="tableSection"><table><tr><th class="ps_exceptionNameColumn">Exception</th><th class="ps_exceptionConditionColumn">Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>Not full path.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/c18k6c59" target="_blank">Exception</a></td><td>Exceptions of the file-write function.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/hccy4eyd" target="_blank">IOException</a></td><td>Failed to replace file. The file-write function also can thow it.</td></tr></table></div><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>            The file-write functions provided by .NET and Windows API are unreliable, because:<br />            1. Fails if the file is temporarily open by another process or thread without sharing.<br />            2. Can corrupt file data. If this thread, process, PC or disk dies while writing, may write only part of data or just make empty file. Usually it happens when PC is turned off incorrectly.<br />            To protect from 1, this functions waits/retries if the file is temporarily open/locked, like <a href="M_Au_File__WaitIfLocked.htm">File_.WaitIfLocked</a>.<br />            To protect from 2, this function writes to a temporary file and renames/replaces the specified file using API <a href="https://www.google.com/search?q=site:docs.microsoft.com+ReplaceFile" target="_blank">ReplaceFile</a>. Although not completely atomic, it ensures that file data is not corrupt; if cannot write all data, does not change existing file data.
            <div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_File_.htm">File_ Class</a></div><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>