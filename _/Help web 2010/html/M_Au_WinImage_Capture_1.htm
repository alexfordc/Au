<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>WinImage.Capture Method (Wnd, RECT)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Au.WinImage.Capture(Au.Wnd,Au.Types.RECT)" /><meta name="Description" content="Creates image from a rectangle of window client area pixels." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="M_Au_WinImage_Capture_1" /><meta name="guid" content="M_Au_WinImage_Capture_1" /><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>WinImage<span id="LST80BA0F9E_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80BA0F9E_0?cpp=::|nu=.");</script>Capture Method (Wnd, RECT)</h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">
            Creates image from a rectangle of window client area pixels.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Bitmap</span> <span class="identifier">Capture</span>(
	<span class="identifier">Wnd</span> <span class="parameter">w</span>,
	<span class="identifier">RECT</span> <span class="parameter">rect</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">w</span></dt><dd>Type: <a href="T_Au_Wnd.htm">Au<span id="LST80BA0F9E_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80BA0F9E_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Wnd</a><br />Window or control.</dd><dt><span class="parameter">rect</span></dt><dd>Type: <a href="T_Au_Types_RECT.htm">Au.Types<span id="LST80BA0F9E_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80BA0F9E_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>RECT</a><br />A rectangle in w client area coordinates. Use <span class="code">w.ClientRect</span> to get whole client area.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/4e7y164x" target="_blank">Bitmap</a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Exceptions</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="tableSection"><table><tr><th class="ps_exceptionNameColumn">Exception</th><th class="ps_exceptionConditionColumn">Condition</th></tr><tr><td><a href="T_Au_Types_WndException.htm">WndException</a></td><td>Invalid w.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>Empty rectangle.</td></tr><tr><td><a href="T_Au_Types_AuException.htm">AuException</a></td><td>Failed. Probably there is not enough memory for bitmap of this size (with*height*4 bytes).</td></tr></table></div><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>
            How this is different from <a href="M_Au_WinImage_Capture.htm">WinImage.Capture</a>:<br />            1. Gets pixels from window's device context (DC), not from screen DC, unless the Aero theme is turned off (on Windows 7). The window can be under other windows. The image can be different.<br />            2. If the window is partially or completely transparent, gets non-transparent image.<br />            3. Does not work with Windows Store app windows, Chrome and some other windows. Creates black image.<br />            4. If the window is DPI-scaled, captures its non-scaled view. And <span class="parameter">rect</span> must contain non-scaled coordinates.
            <div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_WinImage.htm">WinImage Class</a></div><div class="seeAlsoStyle"><a href="Overload_Au_WinImage_Capture.htm">Capture Overload</a></div><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>