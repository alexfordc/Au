<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Icon_.ImageCache.GetImage Method (String, Boolean, GIFlags, Action(Bitmap, Object), Object)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Au.Icon_.ImageCache.GetImage(System.String,System.Boolean,Au.Types.GIFlags,System.Action{System.Drawing.Bitmap,System.Object},System.Object)" /><meta name="Description" content="Gets file icon as Bitmap. If it is in the memory cache, gets it from there. Else if it is in the file cache, gets it from there and adds to the memory cache. Else gets from file (uses Icon_." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="M_Au_Icon__ImageCache_GetImage" /><meta name="guid" content="M_Au_Icon__ImageCache_GetImage" /><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>Icon_<span id="LST8DF135A5_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_0?cpp=::|nu=.");</script>ImageCache<span id="LST8DF135A5_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_1?cpp=::|nu=.");</script>GetImage Method (String, Boolean, GIFlags, Action<span id="LST8DF135A5_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_2?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script>Bitmap, Object<span id="LST8DF135A5_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_3?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script>, Object)</h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">
            Gets file icon as <b>Bitmap</b>.<br />            If it is in the memory cache, gets it from there.<br />            Else if it is in the file cache, gets it from there and adds to the memory cache.<br />            Else gets from file (uses <a href="M_Au_Icon__GetFileIconImage.htm">Icon_.GetFileIconImage</a> and adds to the file cache and to the memory cache.<br />            Returns null if <b>GetFileIconImage</b> failed, eg file does not exist.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Bitmap</span> <span class="identifier">GetImage</span>(
	<span class="identifier">string</span> <span class="parameter">file</span>,
	<span class="identifier">bool</span> <span class="parameter">useExt</span>,
	<span class="identifier">GIFlags</span> <span class="parameter">giFlags</span> = ,
	<span class="identifier">Action</span>&lt;<span class="identifier">Bitmap</span>, <span class="identifier">Object</span>&gt; <span class="parameter">autoUpdate</span> = <span class="keyword">null</span>,
	<span class="identifier">Object</span> <span class="parameter">auParam</span> = <span class="keyword">null</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">file</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST8DF135A5_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />Any file or folder.</dd><dt><span class="parameter">useExt</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST8DF135A5_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />            Get file type icon, depending on filename extension. Use this to avoid getting separate image object for each file of same type.<br />            This is ignored if filename extension is ".ico" or ".exe" or starts with ".exe," or ".dll,".</dd><dt><span class="parameter">giFlags</span> (Optional)</dt><dd>Type: <a href="T_Au_Types_GIFlags.htm">Au.Types<span id="LST8DF135A5_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>GIFlags</a><br />Flags for <a href="M_Au_Icon__GetFileIconImage.htm">Icon_.GetFileIconImage</a>.</dd><dt><span class="parameter">autoUpdate</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/bb549311" target="_blank">System<span id="LST8DF135A5_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Action</a><span id="LST8DF135A5_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_8?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="http://msdn2.microsoft.com/en-us/library/4e7y164x" target="_blank">Bitmap</a>, <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a><span id="LST8DF135A5_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_9?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />            If not null, the cached image will be auto-updated when changed. Then will be called this function. It can update the image in UI.<br />            How it works: If this function finds cached image, it sets timer that after ~50 ms loads that icon/image from file again and compares with the cached image. If different, updates the cache. Does it once, not periodically.<br />            Use only in UI threads. Does not work if this thread does not retrieve/dispatch posted messages.</dd><dt><span class="parameter">auParam</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LST8DF135A5_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />Something to pass to the <span class="parameter">autoUpdate</span> callback function.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/4e7y164x" target="_blank">Bitmap</a><div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_Icon__ImageCache.htm">Icon_<span id="LST8DF135A5_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8DF135A5_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ImageCache Class</a></div><div class="seeAlsoStyle"><a href="Overload_Au_Icon__ImageCache_GetImage.htm">GetImage Overload</a></div><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>