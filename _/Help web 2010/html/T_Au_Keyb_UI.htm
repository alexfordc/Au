<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Keyb.UI Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Keyb.UI class" /><meta name="System.Keywords" content="Au.Keyb.UI class" /><meta name="Microsoft.Help.F1" content="Au.Keyb.UI" /><meta name="Microsoft.Help.Id" content="T:Au.Keyb.UI" /><meta name="Description" content="Gets key states for using in UI code (forms, WPF)." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="T_Au_Keyb_UI" /><meta name="guid" content="T_Au_Keyb_UI" /><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>Keyb<span id="LST68F9EE30_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68F9EE30_0?cpp=::|nu=.");</script>UI Class</h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">
            Gets key states for using in UI code (forms, WPF).
            </div><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Inheritance Hierarchy</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LST68F9EE30_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68F9EE30_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">Au<span id="LST68F9EE30_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68F9EE30_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Keyb<span id="LST68F9EE30_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68F9EE30_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UI</span><br /><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="identifier">UI</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><p>The <span class="selflink">Keyb<span id="LST68F9EE30_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68F9EE30_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UI</span> type exposes the following members.</p><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Properties</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><table class="members" id="propertyList"><tr><th class="ps_iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsAlt.htm">IsAlt</a></td><td><div class="summary">
            Returns true if the Alt key is down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsCapsLock.htm">IsCapsLock</a></td><td><div class="summary">
            Returns true if the Caps Lock key is toggled.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsCtrl.htm">IsCtrl</a></td><td><div class="summary">
            Returns true if the Ctrl key is down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsNumLock.htm">IsNumLock</a></td><td><div class="summary">
            Returns true if the Num Lock key is toggled.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsScrollLock.htm">IsScrollLock</a></td><td><div class="summary">
            Returns true if the Scroll Lock key is toggled.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsShift.htm">IsShift</a></td><td><div class="summary">
            Returns true if the Shift key is down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="P_Au_Keyb_UI_IsWin.htm">IsWin</a></td><td><div class="summary">
            Returns true if the Win key is down (pressed).
            </div></td></tr></table><a href="#mainBody">Top</a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Methods</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><table class="members" id="methodList"><tr><th class="ps_iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_GetKeyState.htm">GetKeyState</a></td><td><div class="summary">
            Calls API <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyState" target="_blank">GetKeyState</a> and returns its return value.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_GetMod.htm">GetMod</a></td><td><div class="summary">
            Gets flags indicating which modifier keys are down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_IsMod.htm">IsMod</a></td><td><div class="summary">
            Returns true if some modifier keys are down (pressed).
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="M_Au_Keyb_UI_IsPressed.htm">IsPressed</a></td><td><div class="summary">
            Returns true if the specified key or mouse button is down (pressed).
            </div></td></tr></table><a href="#mainBody">Top</a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>
            Use functions of this class when processing user input events in user interface code (forms, WPF). In other code (automation scrits, etc) usually it's better to use functions of <a href="T_Au_Keyb.htm">Keyb</a> class. Functions of this class are similar to .NET's <b>Control.ModifierKeys</b>, <b>Keyboard.Modifiers</b> etc, but may be easier to use.<br /><br />            In Windows there are two API to get key state (down or up) - <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyState" target="_blank">GetKeyState</a> and <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetAsyncKeyState" target="_blank">GetAsyncKeyState</a>. In most cases they return the same result, but not always.<br /><br />            API <b>GetAsyncKeyState</b> is used by class <a href="T_Au_Keyb.htm">Keyb</a> and not by this class (<b>Keyb.UI</b>). When the user (or some software) presses or releases a key, <b>GetAsyncKeyState</b> sees the change immediately. It is good in automation scripts, but not good in UI code because the state is not synchronized with the message queue.<br /><br />            This class (<b>Keyb.UI</b>) uses API <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyState" target="_blank">GetKeyState</a>. In the foreground thread (of the active window), it sees key state changes not immediately but after the thread reads key messages from its queue. It is good in UI threads. In background threads this API usually works like <b>GetAsyncKeyState</b>, but it depends on API <a href="https://www.google.com/search?q=site:docs.microsoft.com+AttachThreadInput" target="_blank">AttachThreadInput</a> and in some cases is less reliable, for example may be unaware of keys pressed before the thread started.<br /><br />            The key state returned by these API is not always the same as of the physical keyboard. There is no API to get physical state. The two most common cases when it is different:<br />            1. When the key is pressed or released by software, such as the <b>Key</b> function of this library.<br />            2. When the key is blocked by a low-level hook. For example, hotkey triggers of this library use hooks.<br /><br />            Also there is API <a href="https://www.google.com/search?q=site:docs.microsoft.com+GetKeyboardState" target="_blank">GetKeyboardState</a>. It gets states of all keys in single call. Works like <b>GetKeyState</b>.
            <div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>