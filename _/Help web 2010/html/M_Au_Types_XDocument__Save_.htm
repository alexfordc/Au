<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XDocument_.Save_ Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Save_ method" /><meta name="System.Keywords" content="XDocument_.Save_ method" /><meta name="Microsoft.Help.F1" content="Au.Types.XDocument_.Save_" /><meta name="Microsoft.Help.Id" content="M:Au.Types.XDocument_.Save_(System.Xml.Linq.XDocument,System.String,System.Boolean,System.Nullable{System.Xml.Linq.SaveOptions})" /><meta name="Description" content="Saves XML to a file in a safer way. Uses System.Xml.Linq.XDocument.Save and File_.Save" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au.Types" /><meta name="file" content="M_Au_Types_XDocument__Save_" /><meta name="guid" content="M_Au_Types_XDocument__Save_" /><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>XDocument_<span id="LST1B5BD82_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_0?cpp=::|nu=.");</script>Save_ Method </h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">            Saves XML to a file in a safer way.<br />            Uses <a href="http://msdn2.microsoft.com/en-us/library/bb345830" target="_blank">System.Xml.Linq.XDocument.Save</a> and <a href="M_Au_File__Save.htm">File_.Save</a></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au_Types.htm">Au.Types</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">Save_</span>(
	<span class="keyword">this</span> <span class="identifier">XDocument</span> <span class="parameter">t</span>,
	<span class="identifier">string</span> <span class="parameter">file</span>,
	<span class="identifier">bool</span> <span class="parameter">backup</span> = <span class="keyword">false</span>,
	<span class="identifier">Nullable</span>&lt;<span class="identifier">SaveOptions</span>&gt; <span class="parameter">options</span> = <span class="keyword">null</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">t</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/bb345449" target="_blank">System.Xml.Linq<span id="LST1B5BD82_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>XDocument</a><br /></dd><dt><span class="parameter">file</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST1B5BD82_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />File. Must be full path. Can contain environment variables etc, see <a href="M_Au_Path__ExpandEnvVar.htm">Path_.ExpandEnvVar</a>. The file can exist or not; this function overwrites it.</dd><dt><span class="parameter">backup</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST1B5BD82_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />Create backup file named file + "~backup".</dd><dt><span class="parameter">options</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/b3h38hb0" target="_blank">System<span id="LST1B5BD82_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Nullable</a><span id="LST1B5BD82_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_5?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="http://msdn2.microsoft.com/en-us/library/bb551441" target="_blank">SaveOptions</a><span id="LST1B5BD82_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST1B5BD82_6?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br /></dd></dl><h4 class="subHeading">Usage Note</h4>In Visual Basic and C#, you can call this method as an instance method on any object of type <a href="http://msdn2.microsoft.com/en-us/library/bb345449" target="_blank">XDocument</a>. When you use instance method syntax to call this method, omit the first parameter. For more information, see <a href="http://msdn.microsoft.com/en-us/library/bb384936.aspx" target="_blank">Extension Methods (Visual Basic)</a> or <a href="http://msdn.microsoft.com/en-us/library/bb383977.aspx" target="_blank">Extension Methods (C# Programming Guide)</a>.<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Exceptions</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="tableSection"><table><tr><th class="ps_exceptionNameColumn">Exception</th><th class="ps_exceptionConditionColumn">Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/c18k6c59" target="_blank">Exception</a></td><td>Exceptions of <a href="http://msdn2.microsoft.com/en-us/library/bb345830" target="_blank">System.Xml.Linq.XDocument.Save</a> and <a href="M_Au_File__Save.htm">File_.Save</a>.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>Not full path.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/hccy4eyd" target="_blank">IOException</a></td><td>Failed to replace file. The file-write function also can thow it.</td></tr></table></div><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>            The file-write functions provided by .NET and Windows API are unreliable, because:<br />            1. Fails if the file is temporarily open by another process or thread without sharing.<br />            2. Can corrupt file data. If this thread, process, PC or disk dies while writing, may write only part of data or just make empty file. Usually it happens when PC is turned off incorrectly.<br />            To protect from 1, this functions waits/retries if the file is temporarily open/locked, like <a href="M_Au_File__WaitIfLocked.htm">File_.WaitIfLocked</a>.<br />            To protect from 2, this function writes to a temporary file and renames/replaces the specified file using API <a href="https://www.google.com/search?q=site:docs.microsoft.com+ReplaceFile" target="_blank">ReplaceFile</a>. Although not completely atomic, it ensures that file data is not corrupt; if cannot write all data, does not change existing file data.
            <div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_Types_XDocument_.htm">XDocument_ Class</a></div><div class="seeAlsoStyle"><a href="N_Au_Types.htm">Au.Types Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>