<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Wnd.FindOrRun Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="FindOrRun method" /><meta name="System.Keywords" content="Wnd.FindOrRun method" /><meta name="Microsoft.Help.F1" content="Au.Wnd.FindOrRun" /><meta name="Microsoft.Help.Id" content="M:Au.Wnd.FindOrRun(System.String,System.String,Au.Types.WF3,Au.Types.WFFlags,System.Func{Au.Wnd,System.Boolean},System.Object,System.Action,System.Double,System.Boolean)" /><meta name="Description" content="Finds a top-level window (Wnd.Find). If found, activates (optionally), else calls callback function and waits for the window. The callback should open the window, for example call Shell.Run. Returns window handle as Wnd." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="M_Au_Wnd_FindOrRun" /><meta name="guid" content="M_Au_Wnd_FindOrRun" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>Wnd<span id="LST4AA6DE90_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_0?cpp=::|nu=.");</script>FindOrRun Method </h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">
            Finds a top-level window (<a href="M_Au_Wnd_Find.htm">Wnd.Find</a>). If found, activates (optionally), else calls callback function and waits for the window. The callback should open the window, for example call <a href="M_Au_Shell_Run.htm">Shell.Run</a>.<br />            Returns window handle as Wnd. Returns default(Wnd) if not found (if <span class="parameter">runWaitS</span> is negative; else exception).
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Wnd</span> <span class="identifier">FindOrRun</span>(
	<span class="identifier">string</span> <span class="parameter">name</span> = <span class="keyword">null</span>,
	<span class="identifier">string</span> <span class="parameter">cn</span> = <span class="keyword">null</span>,
	<span class="identifier">WF3</span> <span class="parameter">program</span> = <span class="keyword">null</span>,
	<span class="identifier">WFFlags</span> <span class="parameter">flags</span> = ,
	<span class="identifier">Func</span>&lt;<span class="identifier">Wnd</span>, <span class="identifier">bool</span>&gt; <span class="parameter">also</span> = <span class="keyword">null</span>,
	<span class="identifier">Object</span> <span class="parameter">contains</span> = <span class="keyword">null</span>,
	<span class="identifier">Action</span> <span class="parameter">run</span> = <span class="keyword">null</span>,
	<span class="identifier">double</span> <span class="parameter">runWaitS</span> = 60,
	<span class="identifier">bool</span> <span class="parameter">needActiveWindow</span> = <span class="keyword">true</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">name</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST4AA6DE90_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />             Window name. Usually it is the title bar text.<br />             String format: <a href="0248143b-a0dd-4fa1-84f9-76831db6714a.htm">wildcard expression</a>.<br />             null means 'can be any'. "" means 'must not have name'.</dd><dt><span class="parameter">cn</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST4AA6DE90_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />             Window class name.<br />             String format: <a href="0248143b-a0dd-4fa1-84f9-76831db6714a.htm">wildcard expression</a>.<br />             null means 'can be any'. Cannot be "".<br />             You can see window name, class name and program in editor's status bar and dialog "Find window or control".</dd><dt><span class="parameter">program</span> (Optional)</dt><dd>Type: <a href="T_Au_Types_WF3.htm">Au.Types<span id="LST4AA6DE90_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WF3</a><br />             Program file name, like "notepad.exe".<br />             String format: <a href="0248143b-a0dd-4fa1-84f9-76831db6714a.htm">wildcard expression</a>.<br />             null means 'can be any'. Cannot be "". Cannot be path.<br />             Or <a href="M_Au_Types_WF3_Process.htm">WF3.Process</a>(process id), <a href="M_Au_Types_WF3_Thread.htm">WF3.Thread</a>(thread id), <a href="M_Au_Types_WF3_Owner.htm">WF3.Owner</a>(owner window).<br />             See <a href="P_Au_Wnd_ProcessId.htm">Wnd.ProcessId</a>, <a href="P_Au_Process__CurrentProcessId.htm">Process_.CurrentProcessId</a>, <a href="P_Au_Wnd_ThreadId.htm">Wnd.ThreadId</a>, <a href="P_Au_Thread__NativeId.htm">Thread_.NativeId</a>, <a href="P_Au_Wnd_Owner.htm">Wnd.Owner</a>.
             </dd><dt><span class="parameter">flags</span> (Optional)</dt><dd>Type: <a href="T_Au_Types_WFFlags.htm">Au.Types<span id="LST4AA6DE90_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WFFlags</a><br /></dd><dt><span class="parameter">also</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/bb549151" target="_blank">System<span id="LST4AA6DE90_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Func</a><span id="LST4AA6DE90_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_6?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="T_Au_Wnd.htm">Wnd</a>, <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a><span id="LST4AA6DE90_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_7?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />             Callback function. Called for each matching window.<br />             It can evaluate more properties of the window and return true when they match.<br />             Example: <span class="code">also: t =&gt; !t.IsPopupWindow</span>.<br /><br />             Called after evaluating all other parameters except <span class="parameter">contains</span>.
             </dd><dt><span class="parameter">contains</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LST4AA6DE90_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />             Text, image or other object in the client area of the window. Depends on type:<br /><a href="T_Au_Acc_Finder.htm">Acc.Finder</a> - arguments for <a href="M_Au_Acc_Find.htm">Acc.Find</a>. Defines an accessible object that must be in the window.<br /><a href="T_Au_Wnd_ChildFinder.htm">Wnd.ChildFinder</a> - arguments for <a href="M_Au_Wnd_Child.htm">Wnd.Child</a>. Defines a child control that must be in the window.<br /><a href="http://msdn2.microsoft.com/en-us/library/4e7y164x" target="_blank">System.Drawing.Bitmap</a> or other, except string - image(s) or color(s) that must be visible in the window. This function calls <a href="M_Au_WinImage_Find.htm">WinImage.Find</a> with flag <a href="T_Au_Types_WIFlags.htm">WIFlags.WindowDC</a>, and uses this value for the <i>image</i> parameter. See also <a href="M_Au_WinImage_LoadImage.htm">WinImage.LoadImage</a>.<br />             string - an object that must be in the window. Depends on string format:<ul><li>"a 'role' name" or "name" or "a 'role'" - accessible object. See <a href="M_Au_Acc_Find.htm">Acc.Find</a>.</li><li>"c 'cn' name" or "c '' name" or "c 'cn'" - child control. See <a href="M_Au_Wnd_Child.htm">Wnd.Child</a>.</li><li>"image:..." - image. See <a href="M_Au_WinImage_Find.htm">WinImage.Find</a>, <a href="M_Au_WinImage_LoadImage.htm">WinImage.LoadImage</a>.</li></ul><br />             This parameter is evaluated after <span class="parameter">also</span>.
             </dd><dt><span class="parameter">run</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/bb534741" target="_blank">System<span id="LST4AA6DE90_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Action</a><br />Callback function. See example.</dd><dt><span class="parameter">runWaitS</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/643eft0t" target="_blank">System<span id="LST4AA6DE90_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Double</a><br />How long to wait for the window after calling the callback function. Seconds. Default 60. See <a href="M_Au_Wnd_Wait.htm">Wnd.Wait</a>.</dd><dt><span class="parameter">needActiveWindow</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST4AA6DE90_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4AA6DE90_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />Finally the window must be active. Default: true.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="T_Au_Wnd.htm">Wnd</a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Exceptions</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="tableSection"><table><tr><th class="ps_exceptionNameColumn">Exception</th><th class="ps_exceptionConditionColumn">Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/cke1faa2" target="_blank">TimeoutException</a></td><td><span class="parameter">runWaitS</span> time has expired. Not thrown if <span class="parameter">runWaitS</span> &lt;= 0.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td><span class="parameter">cn</span> is "". To match any, use null.<br /><span class="parameter">program</span> is "" or 0 or contains \ or /. To match any, use null.<br />             Invalid wildcard expression ("**options " or regular expression).<br />             Invalid image string in <span class="parameter">contains</span>.
             </td></tr></table></div><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>
            The algorithm is:
            <div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EAAIBA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAIBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAIBA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">var</span> w=Wnd.Find(...);
<span class="highlight-keyword">if</span>(w.Is0) { run(); w=Wnd.Wait(runWaitS, needActiveWindow, ...); }
<span class="highlight-keyword">else</span> <span class="highlight-keyword">if</span>(needActiveWindow) w.Activate();
<span class="highlight-keyword">return</span> w;</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAIBA");</script><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Examples</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EAAHBA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAHBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAHBA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Wnd w = Wnd.FindOrRun(<span class="highlight-literal">"* Notepad"</span>, run: () =&gt; Shell.Run(<span class="highlight-literal">"notepad.exe"</span>));
Print(w);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAHBA");</script><div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_Wnd.htm">Wnd Structure</a></div><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>