<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Acc.FindAll Method (Wnd, String, String, String, AFFlags, Func(Acc, Boolean))</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Au.Acc.FindAll(Au.Wnd,System.String,System.String,System.String,Au.Types.AFFlags,System.Func{Au.Acc,System.Boolean})" /><meta name="Description" content="Finds all matching accessible objects in window. Returns array of 0 or more elements." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="M_Au_Acc_FindAll" /><meta name="guid" content="M_Au_Acc_FindAll" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn"><h1>Acc<span id="LST8E2B6E42_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_0?cpp=::|nu=.");</script>FindAll Method (Wnd, String, String, String, AFFlags, Func<span id="LST8E2B6E42_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_1?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script>Acc, Boolean<span id="LST8E2B6E42_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_2?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script>)</h1></td><td class="OH_tdRunningTitleColumn">Au Class Library</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span> <div class="summary">            Finds all matching accessible objects in window.<br />            Returns array of 0 or more elements.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EACA_tabimgleft"> </div><div id="ID0EACA_tab1" class="OH_CodeSnippetContainerTabSolo">C#</div><div class="OH_CodeSnippetContainerTabRightActive" id="ID0EACA_tabimgright"> </div></div><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Acc</span>[] <span class="identifier">FindAll</span>(
	<span class="identifier">Wnd</span> <span class="parameter">w</span>,
	<span class="identifier">string</span> <span class="parameter">role</span> = <span class="keyword">null</span>,
	<span class="identifier">string</span> <span class="parameter">name</span> = <span class="keyword">null</span>,
	<span class="identifier">string</span> <span class="parameter">prop</span> = <span class="keyword">null</span>,
	<span class="identifier">AFFlags</span> <span class="parameter">flags</span> = ,
	<span class="identifier">Func</span>&lt;<span class="identifier">Acc</span>, <span class="identifier">bool</span>&gt; <span class="parameter">also</span> = <span class="keyword">null</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">w</span></dt><dd>Type: <a href="T_Au_Wnd.htm">Au<span id="LST8E2B6E42_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Wnd</a><br />Window or control that contains the AO.</dd><dt><span class="parameter">role</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST8E2B6E42_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />             AO role, like "LINK". Or path, like "ROLE/ROLE/ROLE".<br />             See <a href="P_Au_Acc_Role.htm">Acc.Role</a>. Can be used standard roles (see <a href="T_Au_Types_AccROLE.htm">AccROLE</a>) and custom roles (like "div" in Firefox).<br />             This parameter is string. If you want to use <a href="T_Au_Types_AccROLE.htm">AccROLE</a>: <span class="code">nameof(AccROLE.CHECKBOX)</span>.<br />             Case-sensitive, not wildcard. Use null to match any role. Cannot be "".<br /><br />             Role or path can have a prefix:<ul><li>             "web:" - search only in the visible web page, not in whole window.<br />             Examples: "web:LINK", "web:/LIST/LISTITEM/LINK".<br />             Supports Firefox, Chrome, Internet Explorer (IE) and apps that use their code. With other windows, searches in the first found visible AO that has DOCUMENT role.<div class="alert"><table><tr><th><img src="../icons/alert_note.gif" alt="Note" /> Note</th></tr><tr><td>Chrome web page accessible objects normally are disabled (don't exist). Use prefix "web:" or "chrome:" to enable.</td></tr></table></div>
             Tip: To search only NOT in web pages, use <span class="parameter">prop</span> "notin=DOCUMENT" (Chrome, Firefox) or "notin=PANE" (IE).
             </li><li>"firefox:" - search only in the visible web page of Firefox or Firefox-based web browser. If w window class name starts with "Mozilla", can be used "web:" instead.</li><li>"chrome:" - search only in the visible web page of Chrome or Chrome-based web browser. If w window class name starts with "Chrome", can be used "web:" instead.</li></ul>
             Prefix cannot be used if: <span class="parameter">prop</span> contains "id" or "class"; with flag <a href="T_Au_Types_AFFlags.htm">AFFlags.UIA</a>; searching in Acc (<a href="M_Au_Acc_Find_1.htm">Acc.Find</a>).<br /><br />             Can be used path consisting of roles separated by "/". Examples:<ul><li>"web:DOCUMENT/div/LIST/LISTITEM/LINK" - find LINK using its full path in web page.</li><li>"web:/div/LIST//LINK" - the empty parts mean 'any role'. For example don't need to specify DOCUMENT because in web pages the first part is always DOCUMENT (Firefox, Chrome) or PANE (IE).</li><li>"web:/div/LIST[4]/LISTITEM[-1]/LINK" - the 4 is 1-based index of div child from which to start searching (4-th, then 3-th, 5-th and so on). It can make faster. Negative means 'index from end', for example use -1 to search in reverse order. Flag <a href="T_Au_Types_AFFlags.htm">AFFlags.Reverse</a> is not applied to path parts with indexes. If index is invalid, will use the nearest valid index.</li><li>"web:/div/LIST[4!]/LISTITEM[-1!]/LINK" - like the above, but the LIST must be exactly 4-th child (don't search 3-th, 5-th etc) and the LISTITEM must be the last child. This can be useful when waiting (uses less CPU), however useless if AO indices in the window or web page change often.</li><li>"web://[4]/[-1!]/[2]" - index without role.</li><li>"CLIENT/WINDOW/TREE/TREEITEM[-1]" - path in window or control. The first path part is a direct child AO of the WINDOW AO of the window/control. The WINDOW AO itself is not included in the search; if you need it, instead use <a href="M_Au_Acc_FromWindow.htm">Acc.FromWindow</a>.</li></ul></dd><dt><span class="parameter">name</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST8E2B6E42_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
             AO name (<a href="P_Au_Acc_Name.htm">Acc.Name</a>).<br />             String format: <a href="0248143b-a0dd-4fa1-84f9-76831db6714a.htm">wildcard expression</a>.<br />             null means 'any'. "" means 'empty or unavailable'.</dd><dt><span class="parameter">prop</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST8E2B6E42_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />             Other AO properties and search settings.<br />             Format: one or more "name=value", separated with "\0" or "\0 ", like "description=xxx\0 @href=yyy". Names must match case. Values of string properties are wildcard expressions.<br /><ul><li>
             "class" - search only in child controls that have this class name (see <a href="P_Au_Wnd_ClassName.htm">Wnd.ClassName</a>).<br />             Cannot be used when searching in Acc.</li><li>
             "id" - search only in child controls that have this id (see <a href="P_Au_Wnd_ControlId.htm">Wnd.ControlId</a>). If the value is not a number - Windows Forms control name (see <a href="P_Au_Wnd_NameWinForms.htm">Wnd.NameWinForms</a>); case-sensitive, not wildcard.<br />             Cannot be used when searching in Acc.</li><li>
             "value" - <a href="P_Au_Acc_Value.htm">Acc.Value</a>.
             </li><li>
             "description" - <a href="P_Au_Acc_Description.htm">Acc.Description</a>.
             </li><li>
             "state" - <a href="P_Au_Acc_State.htm">Acc.State</a>. List of states that the AO must have and/or not have.<br />             Example: "state=CHECKED, FOCUSABLE, !DISABLED".<br />             Example: "state=0x100010, !0x1".<br />             Will find AO that has all states without "!" prefix and does not have any of states with "!" prefix.</li><li>
             "rect" - <a href="P_Au_Acc_Rect.htm">Acc.Rect</a>. Can be specified left, top, width and/or height, using <a href="M_Au_Types_RECT_ToString.htm">RECT.ToString</a> format.<br />             Example: "rect={L=1155 T=1182 W=132 H=13}".<br />             Example: "rect={W=132 T=1182}".<br />             The L T coordinates are relative to the primary screen.</li><li>
             "level" - level (see <a href="P_Au_Acc_Level.htm">Acc.Level</a>) at which the AO can be found. Can be exact level, or minimal and maximal level separated by space.<br />             The default value is 0 1000.<br />             Alternatively you can use path in role, like "////LINK".</li><li>
             "elem" - <a href="P_Au_Acc_SimpleElementId.htm">Acc.SimpleElementId</a>.
             </li><li>
             "action" - <a href="P_Au_Acc_DefaultAction.htm">Acc.DefaultAction</a>.
             </li><li>
             "key" - <a href="P_Au_Acc_KeyboardShortcut.htm">Acc.KeyboardShortcut</a>.
             </li><li>
             "help" - <a href="P_Au_Acc_Help.htm">Acc.Help</a>.
             </li><li>
             "uiaid" - <a href="P_Au_Acc_UiaId.htm">Acc.UiaId</a>.
             </li><li>             "maxcc" - when searching, skip children of AO that have more than this number of direct children. It can make faster.<br />             The default value is 10000. It also prevents hanging or crashing when an AO in the object tree has large number of children. For example OpenOffice Calc TABLE has one billion children.</li><li>             "notin" - when searching, skip children of AO that have these roles. It can make faster.<br />             Example: "notin=TREE,LIST,TOOLBAR".<br />             Roles in the list must be separated with "," or ", ". Case-sensitive, not wildcard.<br />             See also: <a href="T_Au_Types_AFFlags.htm">AFFlags.MenuToo</a>.
             </li><li>
             "@attr" - <a href="M_Au_Acc_HtmlAttribute.htm">Acc.HtmlAttribute</a>. Here "attr" is any attribute name.<br />             Example: "@id=example".</li></ul></dd><dt><span class="parameter">flags</span> (Optional)</dt><dd>Type: <a href="T_Au_Types_AFFlags.htm">Au.Types<span id="LST8E2B6E42_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AFFlags</a><br /></dd><dt><span class="parameter">also</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/bb549151" target="_blank">System<span id="LST8E2B6E42_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Func</a><span id="LST8E2B6E42_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_9?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="T_Au_Acc.htm">Acc</a>, <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a><span id="LST8E2B6E42_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_10?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />             Callback function. Called for each matching AO. Let it return true if this is the wanted AO.<br />             Example, the AO must contain point x y: <span class="code">o =&gt; o.GetRect(out var r, o.WndTopLevel) &amp;&amp; r.Contains(266, 33)</span></dd></dl><h4 class="subHeading">Return Value</h4>Type: <span id="LST8E2B6E42_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_11?cpp=array&lt;");</script><a href="T_Au_Acc.htm">Acc</a><span id="LST8E2B6E42_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8E2B6E42_12?cpp=&gt;|vb=()|nu=[]");</script><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Exceptions</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><div class="tableSection"><table><tr><th class="ps_exceptionNameColumn">Exception</th><th class="ps_exceptionConditionColumn">Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td><span class="parameter">role</span> is "" or invalid.<br /><span class="parameter">name</span> is invalid wildcard expression ("**options " or regular expression).<br /><span class="parameter">prop</span> has invalid format or contains unknown property names or invalid wildcard expressions.<br /><span class="parameter">navig</span> string is invalid.<br />             Using flag <a href="T_Au_Types_AFFlags.htm">AFFlags.UIA</a> when searching in web page (role prefix "web:" etc).
             </td></tr><tr><td><a href="T_Au_Types_WndException.htm">WndException</a></td><td>Invalid window (if the function has parameter <span class="parameter">w</span>).</td></tr><tr><td><a href="T_Au_Types_AuException.htm">AuException</a></td><td>Failed. For example, window of a higher <a href="T_Au_Uac.htm">UAC</a> integrity level process.</td></tr></table></div><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>
             To create code for this function, use dialog "Find accessible object". It is form <b>Au.Tools.Form_Acc</b> in Au.Tools.dll.<br /><br />             Walks the tree of accessible objects, until finds a matching AO.<br />             Uses <a href="T_Au_Acc_Finder.htm">Acc.Finder</a>. You can use it directly. See example.<br />             In wildcard expressions supports PCRE regular expressions (prefix "**r ") but not .NET regular expressions (prefix "**R "). They are similar.<br />             To find web page AOs usually it's better to use <a href="M_Au_Acc_Wait.htm">Acc.Wait</a> instead, it's more reliable.<br />             More info in <a href="T_Au_Acc.htm">Acc</a> topic.
             <div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Examples</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div>
            Get all taskbar buttons (Windows 10).
            <div class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EAANBA_copyCode" href="#" class="OH_copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAANBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAANBA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">var</span> w = Wnd.Find(<span class="highlight-keyword">null</span>, <span class="highlight-literal">"Shell_TrayWnd"</span>).OrThrow();
<span class="highlight-keyword">foreach</span>(<span class="highlight-keyword">var</span> a <span class="highlight-keyword">in</span> Acc.FindAll(w, <span class="highlight-literal">"BUTTON"</span>, prop: <span class="highlight-literal">"level=7"</span>)) Print(a);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAANBA");</script><div class="OH_CollapsibleAreaRegion" id="seeAlsoSection"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"> </div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_Acc.htm">Acc Class</a></div><div class="seeAlsoStyle"><a href="Overload_Au_Acc_FindAll.htm">FindAll Overload</a></div><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"> </div></body></html>