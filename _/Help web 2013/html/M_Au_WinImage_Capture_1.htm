<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>WinImage.Capture Method (Wnd, RECT)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Au.WinImage.Capture(Au.Wnd,Au.Types.RECT)" /><meta name="Description" content="Creates image from a rectangle of window client area pixels." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Au" /><meta name="file" content="M_Au_WinImage_Capture_1" /><meta name="guid" content="M_Au_WinImage_Capture_1" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Au Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\3d4fd35d-4b48-4167-b34f-44e9afc13fc3.htm" title="Au Class Library" tocid="roottoc">Au Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_Au.htm" title="Au" tocid="N_Au">Au</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_Au_WinImage.htm" title="WinImage Class" tocid="T_Au_WinImage">WinImage Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_Au_WinImage.htm" title="WinImage Methods" tocid="Methods_T_Au_WinImage">WinImage Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Overload_Au_WinImage_Capture.htm" title="Capture Method " tocid="Overload_Au_WinImage_Capture">Capture Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_WinImage_Capture_3.htm" title="Capture Method (List(POINT))" tocid="M_Au_WinImage_Capture_3">Capture Method (List(POINT))</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_WinImage_Capture.htm" title="Capture Method (RECT)" tocid="M_Au_WinImage_Capture">Capture Method (RECT)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_WinImage_Capture_1.htm" title="Capture Method (Wnd, RECT)" tocid="M_Au_WinImage_Capture_1">Capture Method (Wnd, RECT)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_Au_WinImage_Capture_2.htm" title="Capture Method (Wnd, List(POINT))" tocid="M_Au_WinImage_Capture_2">Capture Method (Wnd, List(POINT))</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>WinImage<span id="LST80BA0F9E_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80BA0F9E_0?cpp=::|nu=.");</script>Capture Method (Wnd, RECT)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Creates image from a rectangle of window client area pixels.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Au.htm">Au</a><br />
    <strong>Assembly:</strong>
   Au (in Au.dll) Version: 1.0.0.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Bitmap</span> <span class="identifier">Capture</span>(
	<span class="identifier">Wnd</span> <span class="parameter">w</span>,
	<span class="identifier">RECT</span> <span class="parameter">rect</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">w</span></dt><dd>Type: <a href="T_Au_Wnd.htm">Au<span id="LST80BA0F9E_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80BA0F9E_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Wnd</a><br />Window or control.</dd><dt><span class="parameter">rect</span></dt><dd>Type: <a href="T_Au_Types_RECT.htm">Au.Types<span id="LST80BA0F9E_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80BA0F9E_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>RECT</a><br />A rectangle in w client area coordinates. Use <span class="code">w.ClientRect</span> to get whole client area.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/4e7y164x" target="_blank">Bitmap</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="T_Au_Types_WndException.htm">WndException</a></td><td>Invalid w.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>Empty rectangle.</td></tr><tr><td><a href="T_Au_Types_AuException.htm">AuException</a></td><td>Failed. Probably there is not enough memory for bitmap of this size (with*height*4 bytes).</td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection">
            How this is different from <a href="M_Au_WinImage_Capture.htm">WinImage.Capture</a>:<br />            1. Gets pixels from window's device context (DC), not from screen DC, unless the Aero theme is turned off (on Windows 7). The window can be under other windows. The image can be different.<br />            2. If the window is partially or completely transparent, gets non-transparent image.<br />            3. Does not work with Windows Store app windows, Chrome and some other windows. Creates black image.<br />            4. If the window is DPI-scaled, captures its non-scaled view. And <span class="parameter">rect</span> must contain non-scaled coordinates.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Au_WinImage.htm">WinImage Class</a></div><div class="seeAlsoStyle"><a href="Overload_Au_WinImage_Capture.htm">Capture Overload</a></div><div class="seeAlsoStyle"><a href="N_Au.htm">Au Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>